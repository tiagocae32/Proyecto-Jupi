CREATE
OR REPLACE TABLE PROYECTO_JUPI.CURATED_ZONE.L2_FACT_PRECIO_ALQUILER (
    ID NUMBER(38, 0) AUTOINCREMENT START 1 INCREMENT 1 PRIMARY KEY,
    ID_BARRIO NUMBER(38, 0),
    ID_TIPO_PROPIEDAD NUMBER(38,0),
    PRECIO NUMBER(38, 0),
    FECHA DATE
);


// 1 Ambiente
INSERT INTO
    PROYECTO_JUPI.CURATED_ZONE.L2_FACT_PRECIO_ALQUILER (ID_BARRIO, ID_TIPO_PROPIEDAD, PRECIO, FECHA)
SELECT
    db.ID,
    1,
    pam.precio,
    CURRENT_DATE
FROM
    PROYECTO_JUPI.LANDING_ZONE.L1_FACT_PRECIO_ALQUILER_MONOAMBIENTE pam
    INNER JOIN PROYECTO_JUPI.LANDING_ZONE.L1_DIM_BARRIOS db ON pam.BARRIO = db.BARRIO;


// 2  Ambientes 
INSERT INTO
    PROYECTO_JUPI.CURATED_ZONE.L2_FACT_PRECIO_ALQUILER (ID_BARRIO, ID_TIPO_PROPIEDAD, PRECIO, FECHA)
SELECT
    db.ID,
    2,
    pam.precio,
    CURRENT_DATE
FROM
    PROYECTO_JUPI.LANDING_ZONE.L1_FACT_PRECIO_ALQUILER_DOS_AMBIENTES pam
    INNER JOIN PROYECTO_JUPI.LANDING_ZONE.L1_DIM_BARRIOS db ON pam.BARRIO = db.BARRIO;


// 3 Ambientes 
INSERT INTO
    PROYECTO_JUPI.CURATED_ZONE.L2_FACT_PRECIO_ALQUILER (ID_BARRIO, ID_TIPO_PROPIEDAD, PRECIO, FECHA)
SELECT
    db.ID,
    3,
    pam.precio,
    CURRENT_DATE
FROM
    PROYECTO_JUPI.LANDING_ZONE.L1_FACT_PRECIO_ALQUILER_TRES_AMBIENTES pam
    INNER JOIN PROYECTO_JUPI.LANDING_ZONE.L1_DIM_BARRIOS db ON pam.BARRIO = db.BARRIO;

    

SELECT * FROM  PROYECTO_JUPI.CURATED_ZONE.L2_FACT_PRECIO_ALQUILER;
