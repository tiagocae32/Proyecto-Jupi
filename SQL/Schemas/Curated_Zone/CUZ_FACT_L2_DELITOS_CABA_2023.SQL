CREATE
OR REPLACE TABLE PROYECTO_JUPI.CURATED_ZONE.L2_FACT_DELITOS_2023_CABA (
    ID_DELITO NUMBER(38, 0) AUTOINCREMENT START 1 INCREMENT 1 PRIMARY KEY,
    TIPO VARCHAR(16777216),
    USO_ARMA VARCHAR(16777216),
    ID_BARRIO NUMBER
);

INSERT INTO PROYECTO_JUPI.CURATED_ZONE.L2_FACT_DELITOS_2023_CABA(
    ID_DELITO ,
    TIPO,
    USO_ARMA ,
    ID_BARRIO 
)(
    SELECT ID_DELITO, TIPO, USO_ARMA, DB.ID_BARRIO FROM PROYECTO_JUPI.LANDING_ZONE.L1_FACT_DELITOS_2023_CABA FDC
    INNER JOIN PROYECTO_JUPI.LANDING_ZONE.L1_DIM_BARRIOS DB ON INITCAP(FDC.BARRIO) = DB.BARRIO
);


SELECT * FROM PROYECTO_JUPI.CURATED_ZONE.L2_FACT_DELITOS_2023_CABA; 