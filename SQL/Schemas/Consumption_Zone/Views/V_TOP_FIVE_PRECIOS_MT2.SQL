CREATE OR REPLACE VIEW PROYECTO_JUPI.CONSUMPTION_ZONE.TOP_FIVE_PRECIOS_MT2 AS (
    SELECT BARRIO, PRECIO_USD
    FROM (
        SELECT DM.BARRIO, FCMT2.PRECIO_USD,
               ROW_NUMBER() OVER (ORDER BY FCMT2.PRECIO_USD DESC) AS RN
        FROM PROYECTO_JUPI.CURATED_ZONE.CUZ_TBL_L2_FACT_COMPRA_MT2 FCMT2
        INNER JOIN PROYECTO_JUPI.LANDING_ZONE.L1_DIM_BARRIOS DM
        ON FCMT2.ID_BARRIO = DM.ID_BARRIO
    ) AS Subquery
    WHERE RN > 1 AND RN <= 6
);



SELECT * FROM PROYECTO_JUPI.CONSUMPTION_ZONE.TOP_FIVE_PRECIOS_MT2;