CREATE
OR REPLACE VIEW PROYECTO_JUPI.CONSUMPTION_ZONE.COMPRA_DEPTO AS (
    SELECT
        DB.COMUNA,
        DB.ID_BARRIO,
        DB.BARRIO,
        DB.LATITUD,
        DB.LONGITUD,
        TIPO_DEPTO.ID_TIPO_DEPARTAMENTO,
        TIPO_DEPTO.TIPO_DEPARTAMENTO,
        (FPM.PRECIO_USD * TIPO_DEPTO.MT2_PROMEDIO) AS PRECIO_DEPTO_USD
    FROM
        PROYECTO_JUPI.CURATED_ZONE.L2_FACT_COMPRA_MT2 FPM
        INNER JOIN PROYECTO_JUPI.LANDING_ZONE.L1_DIM_BARRIOS DB ON FPM.ID_BARRIO = DB.ID_BARRIO
        CROSS JOIN (
            SELECT
                1 AS ID_TIPO_DEPARTAMENTO,
                '1 Ambiente' AS TIPO_DEPARTAMENTO,
                30 AS MT2_PROMEDIO
            UNION ALL
            SELECT
                2,
                '2 Ambientes',
                43
            UNION ALL
            SELECT
                3,
                '3 Ambientes',
                70
        ) TIPO_DEPTO
);
SELECT
    *
FROM
    PROYECTO_JUPI.CONSUMPTION_ZONE.COMPRA_DEPTO;